syntax = "proto3";

package seigr;

import "common.proto"; // Import for ThreatLevel if needed

// Enum for defining the priority levels for replication requests
enum ReplicationPriority {
    PRIORITY_UNDEFINED = 0;
    PRIORITY_LOW = 1;                          // Low-priority replication
    PRIORITY_MEDIUM = 2;                       // Standard priority
    PRIORITY_HIGH = 3;                         // High priority for frequently accessed data
    PRIORITY_CRITICAL = 4;                     // Critical priority for high-risk or high-value data
}

// Enum for defining the types of replication triggers
enum ReplicationTrigger {
    REPLICATION_TRIGGER_UNDEFINED = 0;
    REPLICATION_TRIGGER_MANUAL_REQUEST = 1;
    REPLICATION_TRIGGER_DEMAND_BASED = 2;
    REPLICATION_TRIGGER_IMMUNE_SYSTEM_ALERT = 3;
    REPLICATION_TRIGGER_PERIODIC_CHECK = 4;
    REPLICATION_TRIGGER_NETWORK_EXPANSION = 5;
}

// Enum for defining replication strategies
enum ReplicationStrategy {
    REPLICATION_STRATEGY_UNDEFINED = 0;
    REPLICATION_STRATEGY_DEMAND_BASED = 1;
    REPLICATION_STRATEGY_PERIODIC = 2;
    REPLICATION_STRATEGY_FULL = 3;
    REPLICATION_STRATEGY_ADAPTIVE = 4;
}

// Consolidated message for replication requests used across multiple contexts
message ReplicationRequest {
    string request_id = 1;                     // Unique identifier for the replication request
    string segment_id = 2;                     // ID or hash of the data segment to be replicated
    ThreatLevel threat_level = 3;              // Threat level if applicable
    ReplicationPriority priority = 4;          // Priority level of the replication
    ReplicationTrigger trigger = 5;            // Trigger type initiating the replication
    ReplicationStrategy strategy = 6;          // Strategy used for replication
    bool critical_replication = 7;             // Indicates if this is a critical replication
    string requested_by = 8;                   // hyphen or user ID initiating the request
    string request_timestamp = 9;              // Timestamp of the request
    map<string, string> parameters = 10;       // Parameters for replication specifics
    string reason = 11;                        // Reason for replication (e.g., "data integrity concern")
}
