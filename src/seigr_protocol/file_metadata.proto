syntax = "proto3";

package seigr;

import "segment_metadata.proto"; // Importing SegmentMetadata for segment structure

// Enum defining file types in Seigr (e.g., binary, custom formats)
enum FileType {
    FILE_UNDEFINED = 0;
    BINARY = 1;
    SENARY = 2;
    CUSTOM_FORMAT = 3;              // Placeholder for future custom formats
    TEXT = 4;                       // Text file
    IMAGE = 5;                      // Image file
    VIDEO = 6;                      // Video file
    AUDIO = 7;                      // Audio file
    ARCHIVE = 8;                    // Archive file (e.g., ZIP)
    DATABASE = 9;                   // Database file format
}

// Message for tracking file operations across its lifecycle
message OperationLog {
    string operation_type = 1;       // Operation type (e.g., "create", "update", "rollback")
    string performed_by = 2;         // ID for the user or system performing the operation
    string timestamp = 3;            // ISO 8601 timestamp of the operation
    string status = 4;               // Status of the operation (e.g., "SUCCESS", "FAILURE")
    string details = 5;              // Additional details about the operation
    map<string, string> metadata = 6; // Additional metadata for future extensibility
}

// Message for managing historical snapshots and rollback with temporal layers
message TemporalLayer {
    string timestamp = 1;                          // Creation timestamp for this layer
    repeated SegmentMetadata segments = 2;         // Segment metadata for each segment in the layer
    string layer_hash = 3;                         // Integrity hash of the entire layer
    map<string, bytes> data_snapshot = 4;          // Snapshot data for rollback
    string previous_layer_hash = 5;                // Hash of the previous layer for rollback lineage
    bool rollback_allowed = 6;                     // Flag indicating if rollback to this layer is allowed
    map<string, string> metadata = 7;              // Additional metadata for layer tracking
}

// Primary message for file metadata within the Seigr ecosystem
message FileMetadata {
    string version = 1;                            // Version identifier for `.seigr` format
    string creator_id = 2;                         // Unique ID of the fileâ€™s creator
    FileType file_type = 3;                        // File type (e.g., binary, senary)
    string original_filename = 4;                  // Name of the file before segmentation
    string original_extension = 5;                 // Original file extension
    string creation_timestamp = 6;                 // Initial creation timestamp
    string file_hash = 7;                          // Overall hash for integrity verification
    repeated SegmentMetadata segments = 8;         // Segment metadata for individual file segments
    repeated TemporalLayer temporal_layers = 9;    // Historical layers for rollback support
    repeated OperationLog operation_logs = 10;     // Log of file lifecycle events
    map<string, string> custom_attributes = 11;    // Custom attributes for metadata extensibility
    string access_policy_id = 12;                  // Optional link to an access policy
    string encryption_protocol = 13;               // Encryption protocol (e.g., "HyphaCrypt")
    string network_protocol = 14;                  // Network protocol (e.g., "IPFS", "HYPHEN")
    string integrity_verification_hash = 15;       // Comprehensive hash for integrity verification
    int32 redundancy_level = 16;                   // Redundancy level for file segments
    repeated string authorized_users = 17;         // Authorized user IDs for access
    map<string, string> protocol_attributes = 18;  // Protocol-specific attributes (e.g., keys, geographic location)
    repeated string access_control_list = 19;      // Direct ACL references for access control
}
